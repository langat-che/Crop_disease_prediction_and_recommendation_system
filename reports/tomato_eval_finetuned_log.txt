2025-04-22 13:11:39.105651: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-22 13:11:42.561997: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
--- Starting Evaluation for Model: models\tomato_finetuned_L100_ftlr5e-06_from_tomato_initial_best_img160_dr0.4_lr0.001_aug_mild.keras ---

Step 1: Getting paths and class information...
Found 14 classes for tomato: ['Healthy_fruit', 'Mite_P', 'Tomato_late_blight_d', 'alternaria_d', 'alternaria_mite_d', 'bacterial_floundering_d', 'blossom_end_rot_d', 'fusarium_d', 'healthy_leaf', 'helicoverpa_armigera_p', 'nitrogen_exces_d', 'sunburn_d', 'tuta_absoluta_p', 'virosis_d']
Using Image Size: (160, 160)
Using Class Names: ['Healthy_fruit', 'Mite_P', 'Tomato_late_blight_d', 'alternaria_d', 'alternaria_mite_d', 'bacterial_floundering_d', 'blossom_end_rot_d', 'fusarium_d', 'healthy_leaf', 'helicoverpa_armigera_p', 'nitrogen_exces_d', 'sunburn_d', 'tuta_absoluta_p', 'virosis_d']

Step 2: Loading and configuring test dataset...
  Configuring dataset from: Data\tomato_with_data_augmentation\test
  Image Size: (160, 160), Batch Size: 8, Shuffle Files: False, Augment: False (mild)
Found 8438 files belonging to 14 classes.
2025-04-22 13:11:52.628968: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-22 13:14:19.338053: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
  Found 8440 files belonging to 14 classes.
  Dataset caching enabled.
  Dataset prefetching enabled.

Step 3: Loading model from models\tomato_finetuned_L100_ftlr5e-06_from_tomato_initial_best_img160_dr0.4_lr0.001_aug_mild.keras...
  Model loaded successfully.

Step 4: Evaluating model performance...

--- Overall Performance ---
  Test Loss: 1.1387
  Test Accuracy: 0.7499 (74.99%)

Step 5: Generating predictions for detailed reports...
  Generated predictions for 8438 samples.
  Scikit-learn Accuracy (Verification): 0.7499

Step 6: Generating Classification Report...
                         precision    recall  f1-score   support

          Healthy_fruit     0.8601    0.9115    0.8851       904
                 Mite_P     0.6723    0.4103    0.5096       580
   Tomato_late_blight_d     0.7155    0.6975    0.7064       238
           alternaria_d     0.4792    0.7793    0.5935       444
      alternaria_mite_d     0.9322    0.4622    0.6180       119
bacterial_floundering_d     0.4710    0.9079    0.6202       304
      blossom_end_rot_d     0.6012    0.7647    0.6731       272
             fusarium_d     0.7407    0.1724    0.2797       232
           healthy_leaf     0.8760    0.5803    0.6981      1363
 helicoverpa_armigera_p     0.8898    0.5899    0.7095       356
       nitrogen_exces_d     0.8333    0.8261    0.8297       230
              sunburn_d     0.9091    0.6723    0.7729       238
        tuta_absoluta_p     0.9649    0.8029    0.8765       274
              virosis_d     0.7759    0.9029    0.8346      2884

               accuracy                         0.7499      8438
              macro avg     0.7658    0.6772    0.6862      8438
           weighted avg     0.7775    0.7499    0.7423      8438

  Classification report saved to: reports\tomato_finetuned_L100_ftlr5e-06_from_tomato_initial_best_img160_dr0.4_lr0.001_aug_mild_classification_report.txt

Step 7: Generating Confusion Matrix...
Saved confusion matrix plot to: reports\tomato_finetuned_L100_ftlr5e-06_from_tomato_initial_best_img160_dr0.4_lr0.001_aug_mild_confusion_matrix.png

Total evaluation duration: 2.65 minutes.
